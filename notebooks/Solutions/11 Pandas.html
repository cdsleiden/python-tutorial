

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>11. Pandas &#8212; Python Tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Solutions/11 Pandas';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="12. Visualisation" href="12%20Visualisation.html" />
    <link rel="prev" title="10. Data acquisition" href="10%20Data_acquisition.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../Welcome.html">
  
  
  
  
  
    <p class="title logo__title">Python Tutorial</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../Welcome.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1%20Variables_and_data_types.html">1. Statements, variables and data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2%20Operators.html">2. Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3%20Working_with_strings.html">3. Working with strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4%20Flow_control.html">4. Flow control</a></li>

<li class="toctree-l1"><a class="reference internal" href="../5%20Lists.html">5. Lists</a></li>

<li class="toctree-l1"><a class="reference internal" href="../6%20Dictionaries.html">6. Dictionaries</a></li>

<li class="toctree-l1"><a class="reference internal" href="../7%20Functions_modules_and_libraries.html">7. Functions, Modules and Libraries</a></li>

<li class="toctree-l1"><a class="reference internal" href="../8%20Working_with_files_and_folders.html">8. Working with files and folders</a></li>

<li class="toctree-l1"><a class="reference internal" href="../9%20Regular_expressions.html">9. Regular Expressions</a></li>

<li class="toctree-l1"><a class="reference internal" href="../10%20Data_acquisition.html">10. Data acquisition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11%20Pandas.html">11. Data analysis with pandas</a></li>

<li class="toctree-l1"><a class="reference internal" href="../12%20Visualisation.html">12. Data Visualisation</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practical information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Jupyter_notebook_basics.html">Jupyter Notebook basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Other_resources.html">Other resources</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Solutions to the exercises</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1%20Variables_and_data_types.html">1. Statements, variables and data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="2%20Operators.html">2. Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="3%20Working_with_strings.html">3. Working with strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="4%20Flow_control.html">4. Flow control</a></li>
<li class="toctree-l1"><a class="reference internal" href="5%20Lists.html">5. Lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="6%20Dictionaries.html">6. Dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="7%20Functions_modules_and_libraries.html">7. Functions, Modules and Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="8%20Working_with_files_and_folders.html">8. Working with files and folders</a></li>
<li class="toctree-l1"><a class="reference internal" href="9%20Regular_expressions.html">9. Regular expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="10%20Data_acquisition.html">10. Data acquisition</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">11. Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="12%20Visualisation.html">12. Visualisation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cdsleiden/python-tutorial/main?urlpath=tree/notebooks/Solutions/11 Pandas.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/Solutions/11 Pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>11. Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-1">Exercise 11.1.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-2">Exercise 11.2.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-3">Exercise 11.3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-4">Exercise 11.4</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pandas">
<h1>11. Pandas<a class="headerlink" href="#pandas" title="Permalink to this heading">#</a></h1>
<section id="exercise-11-1">
<h2>Exercise 11.1.<a class="headerlink" href="#exercise-11-1" title="Permalink to this heading">#</a></h2>
<p>Download the CSV file ‘nobel.csv’:
<a class="reference external" href="https://edu.nl/3xmbd">https://edu.nl/3xmbd</a></p>
<p>Using the data in this file, try to answer the following questions:</p>
<p>11.1.a. How many Nobel laureates are described in this file?</p>
<p>11.1.b. How many of these are from the Netherlands? What are the names of the Dutch Nobel prize winners?</p>
<p>11.1.c. How many female Nobel laureates are there in this data set? What are their names?</p>
<p>11.1.d. Who was the youngest person ever to receive the Nobel Prize? Who was the oldest person?</p>
<p>Tip: create a new column called ‘Age’, in which the year in which the prize was awarded is subtracted from the year of birth. The year of birth can be extracted from the date of birth using the following code:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">nobel['Birth</span> <span class="pre">Year']</span> <span class="pre">=</span> <span class="pre">pd.to_datetime(nobel['Birth</span> <span class="pre">Date']).dt.year</span></code></p>
</div></blockquote>
<p>11.1.e. For each discipline, calculate the average age of the Nobel laureates.</p>
<p>11.1.f. Create a list of all the unique countries, and calculate the number of Nobel laureates per country.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>

<span class="n">path_to_csv</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="s1">&#39;nobel.csv&#39;</span><span class="p">)</span>
<span class="n">nobel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="n">path_to_csv</span> <span class="p">)</span>

<span class="c1"># Each row describes a nobel laureate</span>
<span class="c1"># The number of rows and columns can be found using &#39;shape&#39;</span>
<span class="c1"># &#39;shape&#39; results in a so-called tuple, with two values. To print only the first value,</span>
<span class="c1"># use shape[0]</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Number of nobel laureates: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nobel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of nobel laureates: 969
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Number of Dutch nobel laureates</span>
<span class="n">dutch</span> <span class="o">=</span> <span class="n">nobel</span><span class="p">[</span> <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Birth Country&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Netherlands&#39;</span> <span class="p">]</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Number of Dutch Nobel laureates: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dutch</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dutch</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Full Name&#39;</span><span class="p">]</span> <span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of Dutch Nobel laureates: 19
Jacobus Henricus van &#39;t Hoff
Hendrik Antoon Lorentz
Pieter Zeeman
Johannes Diderik van der Waals
Tobias Michael Carel Asser
Heike Kamerlingh Onnes
Christiaan Eijkman
Petrus (Peter) Josephus Wilhelmus Debye
Petrus (Peter) Josephus Wilhelmus Debye
Frits Zernike
Jan Tinbergen
Nikolaas Tinbergen
Tjalling C. Koopmans
Nicolaas Bloembergen
Simon van der Meer
Paul J. Crutzen
Gerardus &#39;t Hooft
Martinus J.G. Veltman
Bernard L. Feringa
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Number of Female nobel laureates</span>
<span class="n">female</span> <span class="o">=</span> <span class="n">nobel</span><span class="p">[</span> <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Female&#39;</span> <span class="p">]</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Number of female Nobel laureates: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">female</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">female</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Full Name&#39;</span><span class="p">]</span> <span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of female Nobel laureates: 50
Marie Curie, née Sklodowska
Baroness Bertha Sophie Felicita von Suttner, née Countess Kinsky von Chinic und Tettau
Selma Ottilia Lovisa Lagerlöf
Marie Curie, née Sklodowska
Grazia Deledda
Sigrid Undset
Jane Addams
Irène Joliot-Curie
Pearl Buck
Gabriela Mistral
Emily Greene Balch
Gerty Theresa Cori, née Radnitz
Maria Goeppert Mayer
Dorothy Crowfoot Hodgkin
Nelly Sachs
Betty Williams
Mairead Corrigan
Rosalyn Yalow
Mother Teresa
Alva Myrdal
Barbara McClintock
Rita Levi-Montalcini
Gertrude B. Elion
Nadine Gordimer
Aung San Suu Kyi
Rigoberta Menchú Tum
Toni Morrison
Christiane Nüsslein-Volhard
Wislawa Szymborska
Jody Williams
Shirin Ebadi
Elfriede Jelinek
Linda B. Buck
Wangari Muta Maathai
Doris Lessing
Françoise Barré-Sinoussi
Ada E. Yonath
Elinor Ostrom
Elinor Ostrom
Herta Müller
Elizabeth H. Blackburn
Carol W. Greider
Ellen Johnson Sirleaf
Leymah Gbowee
Tawakkol Karman
Alice Munro
May-Britt Moser
Malala Yousafzai
Svetlana Alexievich
Youyou Tu
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract the year of birth from the birth date</span>
<span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Birth Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Birth Date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>

<span class="c1"># calculate age by subtracting birth year from year of nobel prize </span>
<span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Birth Year&#39;</span><span class="p">]</span>

<span class="c1"># find minimum and maximum in column &#39;Age&#39;</span>
<span class="n">youngest</span> <span class="o">=</span> <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">oldest</span> <span class="o">=</span> <span class="n">nobel</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># print the names of these Nobel laureates, using iterrows()</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">nobel</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">youngest</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The youngest Nobel laureate was </span><span class="si">{}</span><span class="s1">, aged </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Full Name&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">])))</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">oldest</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;The oldest Nobel laureate was </span><span class="si">{}</span><span class="s1">, aged </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Full Name&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The oldest Nobel laureate was Leonid Hurwicz, aged 90.0.
The youngest Nobel laureate was Malala Yousafzai, aged 17.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For each discipline, calculate the average age of the Nobel laureates.</span>
<span class="c1"># First, divide the data frame into groups based on &#39;Category&#39;, using groupby(&#39;Category&#39;)</span>
<span class="c1"># In these groups, select only the &#39;Age&#39; column, by appending [&#39;Age&#39;]</span>
<span class="c1"># Next calculate the mean. The result is a Series object. </span>
<span class="c1"># You can get the indices of this Series using the &#39;index&#39; property</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The average age in each category:&#39;</span><span class="p">)</span>
<span class="n">average_age</span> <span class="o">=</span> <span class="n">nobel</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Category&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 

<span class="nb">print</span><span class="p">(</span> <span class="n">average_age</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The average age in each category:
Category
Chemistry     58.134715
Economics     67.048193
Literature    64.672566
Medicine      57.933921
Peace         61.394231
Physics       55.850000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of all the unique countries, and calculate </span>
<span class="c1"># the number of Nobel laureates per country.</span>
<span class="c1"># First, divide the data frame into groups based on &#39;Birth Country&#39;, using groupby(&#39;Category&#39;)</span>
<span class="c1"># In these groups, select only the &#39;Laureate ID&#39; column, by appending [&#39;Laureate ID&#39;]</span>
<span class="c1"># Next, calculate the number of rows in each group, using count() </span>
<span class="c1"># The result is a Series object. </span>
<span class="c1"># You can get the indices of this Series using the &#39;index&#39; property  </span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The number of Nobel laureates per country&#39;</span><span class="p">)</span>
<span class="n">countries</span> <span class="o">=</span> <span class="n">nobel</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Birth Country&#39;</span><span class="p">)[</span><span class="s1">&#39;Laureate ID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">countries</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">c</span> <span class="p">,</span> <span class="n">countries</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The number of Nobel laureates per country
Argentina: 4
Australia: 11
Austria: 15
Austria-Hungary (Austria): 2
Austria-Hungary (Bosnia and Herzegovina): 1
Austria-Hungary (Croatia): 1
Austria-Hungary (Czech Republic): 4
Austria-Hungary (Hungary): 3
Austria-Hungary (Poland): 1
Austria-Hungary (Slovenia): 1
Austria-Hungary (Ukraine): 1
Austrian Empire (Austria): 2
Austrian Empire (Czech Republic): 1
Austrian Empire (Italy): 1
Bavaria (Germany): 1
Belgium: 9
Bosnia (Bosnia and Herzegovina): 1
Brazil: 1
British India (Bangladesh): 1
British India (India): 1
British Mandate of Palestine (Israel): 5
British Protectorate of Palestine (Israel): 1
British West Indies (Saint Lucia): 1
Bulgaria: 1
Burma (Myanmar): 1
Canada: 18
Chile: 2
China: 12
Colombia: 2
Costa Rica: 1
Crete (Greece): 1
Cyprus: 1
Czechoslovakia (Czech Republic): 1
Denmark: 11
East Friesland (Germany): 1
East Timor: 2
Egypt: 6
Faroe Islands (Denmark): 1
Finland: 2
France: 53
Free City of Danzig (Poland): 1
French Algeria (Algeria): 3
German-occupied Poland (Poland): 1
Germany: 70
Germany (France): 3
Germany (Poland): 10
Germany (Russia): 3
Gold Coast (Ghana): 1
Guadeloupe Island: 1
Guatemala: 2
Hesse-Kassel (Germany): 1
Hungary: 6
Hungary (Slovakia): 1
Iceland: 1
India: 7
India (Pakistan): 3
Iran: 1
Ireland: 5
Italy: 18
Japan: 29
Java, Dutch East Indies (Indonesia): 1
Kenya: 1
Korea (South Korea): 2
Liberia: 2
Lithuania: 1
Luxembourg: 2
Madagascar: 1
Mecklenburg (Germany): 1
Mexico: 3
Morocco: 2
Netherlands: 19
New Zealand: 3
Nigeria: 1
Northern Ireland: 5
Norway: 13
Ottoman Empire (Republic of Macedonia): 1
Ottoman Empire (Turkey): 1
Pakistan: 1
Persia (Iran): 1
Peru: 1
Poland: 6
Poland (Belarus): 1
Poland (Lithuania): 1
Poland (Ukraine): 1
Portugal: 3
Prussia (Germany): 7
Prussia (Poland): 6
Prussia (Russia): 1
Romania: 5
Russia: 20
Russian Empire (Azerbaijan): 1
Russian Empire (Belarus): 2
Russian Empire (Finland): 3
Russian Empire (Latvia): 1
Russian Empire (Lithuania): 1
Russian Empire (Poland): 5
Russian Empire (Russia): 2
Russian Empire (Ukraine): 2
Saint Lucia: 1
Schleswig (Germany): 2
Scotland: 9
South Africa: 9
Southern Rhodesia (Zimbabwe): 1
Spain: 7
Sweden: 30
Switzerland: 17
Taiwan: 1
Tibet (People&#39;s Republic of China): 1
Trinidad: 1
Turkey: 2
Tuscany (Italy): 1
Ukraine: 1
Union of Soviet Socialist Republics (Belarus): 1
Union of Soviet Socialist Republics (Russia): 4
United Kingdom: 88
United States of America: 276
Venezuela: 1
Vietnam: 1
W&amp;uuml;rttemberg (Germany): 1
West Germany (Germany): 5
Yemen: 1
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-11-2">
<h2>Exercise 11.2.<a class="headerlink" href="#exercise-11-2" title="Permalink to this heading">#</a></h2>
<p>Download the Excel file names ‘Grades.xsl’ from the following address:</p>
<p><a class="reference external" href="https://edu.nl/m6w8n">https://edu.nl/m6w8n</a></p>
<p>This spreadsheet contains the partial grades received in a certain course.</p>
<p>Write code which can calculate and print the final grade for each student. The essay and the exam both count for 40% the grade. The remaining 20% is determined by the presentation. All grades should have one digit after the decimal point.</p>
<p>Print a list with the full names of the students, together with their final grade for the course.</p>
<p>Additionally, answer the following questions:</p>
<ul class="simple">
<li><p>Which student has received the highest mark for the essay?</p></li>
<li><p>Which student scored worst on the presentation?</p></li>
<li><p>How many students have received a 6 or lower for the exam?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span> <span class="s1">&#39;Grades.xlsx&#39;</span> <span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;final_mark&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Essay&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Exam&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Presentation&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> 

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Last&#39;</span><span class="p">])</span>

 
<span class="n">best_essays</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Essay&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Essay&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">]</span> 
<span class="n">worst_presentations</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Presentation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Presentation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="p">]</span> 
<span class="n">insufficient_exam</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Exam&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">6</span> <span class="p">]</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best essay:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span> <span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">best_essays</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Last&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Essay&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
    
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Worst presentation:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span> <span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">worst_presentations</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Last&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Presentation&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The following students received an insufficient mark for the exam:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span> <span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">insufficient_exam</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;First&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Last&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Exam&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">nf</span><span class="o">/</span><span class="mi">35</span><span class="n">gdwksd0fx8kzbsljz4dz6hnrcnxq</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_89446</span><span class="o">/</span><span class="mf">2564310518.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span> <span class="s1">&#39;Grades.xlsx&#39;</span> <span class="p">,</span> <span class="n">sheet_name</span> <span class="o">=</span> <span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/util/_decorators.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>                     <span class="n">stacklevel</span><span class="o">=</span><span class="n">stacklevel</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>                 <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">311</span>             <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span> 
<span class="g g-Whitespace">    </span><span class="mi">313</span>         <span class="k">return</span> <span class="n">wrapper</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/excel/_base.py</span> in <span class="ni">read_excel</span><span class="nt">(io, sheet_name, header, names, index_col, usecols, squeeze, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, na_filter, verbose, parse_dates, date_parser, thousands, comment, skipfooter, convert_float, mangle_dupe_cols, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">ExcelFile</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">363</span>         <span class="n">should_close</span> <span class="o">=</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">364</span>         <span class="n">io</span> <span class="o">=</span> <span class="n">ExcelFile</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">365</span>     <span class="k">elif</span> <span class="n">engine</span> <span class="ow">and</span> <span class="n">engine</span> <span class="o">!=</span> <span class="n">io</span><span class="o">.</span><span class="n">engine</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">366</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/excel/_base.py</span> in <span class="ni">__init__</span><span class="nt">(self, path_or_buffer, engine, storage_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">1190</span>             <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1191</span>                 <span class="n">ext</span> <span class="o">=</span> <span class="n">inspect_excel_format</span><span class="p">(</span>
<span class="ne">-&gt; </span><span class="mi">1192</span>                     <span class="n">content_or_path</span><span class="o">=</span><span class="n">path_or_buffer</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span>
<span class="g g-Whitespace">   </span><span class="mi">1193</span>                 <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1194</span>                 <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/excel/_base.py</span> in <span class="ni">inspect_excel_format</span><span class="nt">(content_or_path, storage_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">1069</span> 
<span class="g g-Whitespace">   </span><span class="mi">1070</span>     <span class="k">with</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="ne">-&gt; </span><span class="mi">1071</span>         <span class="n">content_or_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">is_text</span><span class="o">=</span><span class="kc">False</span>
<span class="g g-Whitespace">   </span><span class="mi">1072</span>     <span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1073</span>         <span class="n">stream</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/common.py</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">708</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">709</span>             <span class="c1"># Binary mode</span>
<span class="ne">--&gt; </span><span class="mi">710</span>             <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">711</span>         <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">712</span> 

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;Grades.xlsx&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-11-3">
<h2>Exercise 11.3<a class="headerlink" href="#exercise-11-3" title="Permalink to this heading">#</a></h2>
<p>In the exercise, we make use of the following data set:</p>
<blockquote>
<div><p>Fatah-Black, Dr KJ (Leiden University) (2017): Lijsten van de leveranties, met de namen van de kopers en betaalde prijzen op de verkopingen van de VOC kamer Zeeland, 1725 – 1777. DANS. <a class="reference external" href="https://doi.org/10.17026/dans-23z-ez6f">https://doi.org/10.17026/dans-23z-ez6f</a></p>
</div></blockquote>
<p>This data set lists the goods that have been sold at VOC auctions in Zeeland in the 18th century. For each transaction, data is available about the name of the buyer, the product that was bought, the date of the transaction and the price that was paid. The price is specified in Flemish pounds and groten. 1 Flemish pound was equal to 20 groten.</p>
<p>For the purpose of this exercise, the original data set has been changed slightly. Some rows containing invalid data were removed. Column names and values were also translated into English. The modified CSV file can be downloaded from <a class="reference external" href="https://tdm.universiteitleiden.nl/Python/voc-data.csv">https://tdm.universiteitleiden.nl/Python/voc-data.csv</a></p>
<p>As this data set offers information about the sale of coffee only, we can use these data to trace the historical development of the price of one pound of coffee during the period that is covered by the data set. <strong>Try to create a CSV file containing the following two columns: the full date and the average price of a pound of coffee on that date</strong>.</p>
<p>Follow the steps below.</p>
<p>Firstly, add code below to download the data set. The code to write the file to disk is already provided.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="c1"># FIXME: add code to download the CSV file from the URL &#39;https://tdm.universiteitleiden.nl/Python/voc-data.csv&#39;</span>
<span class="c1"># Make sure to assign the file contents to the data_file variable</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://tdm.universiteitleiden.nl/Python/voc-data.csv&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="n">data_file</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>

<span class="c1"># Write to voc-data.csv in the current working directory</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;voc-data.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output_file</span><span class="p">:</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once you have downloaded the CVS file, you can access the data values in this file using the code below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Let&#39;s load the data into a data frame named `voc`:</span>
<span class="n">voc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;voc-data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To explore the contents data set, write some code to see the number of rows and columns, the columns names and all the values in te first 5 rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">voc</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">voc</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="p">)</span>
<span class="n">voc</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>One difficulty in the original data set is that the year, the month and the day are captured in different columns.</p>
<p>In a time series visualisation, dates can best be represented using a variable of the type <code class="docutils literal notranslate"><span class="pre">datetime</span></code>. Pandas has a convenient method named <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html"><code class="docutils literal notranslate"><span class="pre">pd.to_datetime()</span></code></a> which can assemble a datetime out of multiple columns.</p>
<p>Write some code to add a new column to the existing data frame which can can create a new <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object by combining the values found in the columns named <code class="docutils literal notranslate"><span class="pre">year</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code> and <code class="docutils literal notranslate"><span class="pre">day</span></code>. Save this new datetime object in a column named ‘date’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">voc</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">voc</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>Next, try to calculate the total price that was paid for the product in each individual transaction. Store the result of this calculation in a column named ‘total price’. The total price can be calculated by adding the values in the column ‘flemish_pounds’ and the values in the column ‘groten’, divided by 20.</p>
<p>To be able to compare the prices, they obviously need to be normalised. This can be done by dividing the total price by the amount of coffee that purchased. All quantities are given in pounds, so if we calculate the values in the ‘total price’ column by the quantities, this should result in the price per point. Save the results of this calculation in a column named ‘price_per_pound’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">voc</span><span class="p">[</span><span class="s1">&#39;total_price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">voc</span><span class="p">[</span><span class="s1">&#39;flemish_pounds&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">voc</span><span class="p">[</span><span class="s1">&#39;groten&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">voc</span><span class="p">[</span><span class="s1">&#39;price_per_pound&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">voc</span><span class="p">[</span><span class="s1">&#39;total_price&#39;</span><span class="p">]</span>  <span class="o">/</span> <span class="n">voc</span><span class="p">[</span><span class="s1">&#39;quantity&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The data set contains a number of records with missing data. In such cases, the values in the empty columns are represented using the code <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, which stands for ‘Not a Number’. To remove all the records in which at least on of the column contains a missing value, we can make use of the dropna() method. If we only want to remove records if the have a <code class="docutils literal notranslate"><span class="pre">NaN</span></code> value in a specific column, we can work with the <code class="docutils literal notranslate"><span class="pre">subset</span></code> parameter, which needs to refer to the name of this column, as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">df.dropna(subset</span> <span class="pre">=</span> <span class="pre">['column_name'])</span></code></p>
<p>Add some code which can remove records in which the ‘price_per_pound’ column has a <code class="docutils literal notranslate"><span class="pre">NaN</span></code> value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">voc</span> <span class="o">=</span> <span class="n">voc</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;price_per_pound&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>There is one final operation we need to complete to arrive at the correct values. The original data set contains data about the prices paid in individual transactions. We want to know the average prices per day. Calculate the average prices per day, by making use use of the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> and the <code class="docutils literal notranslate"><span class="pre">mean()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">voc</span> <span class="o">=</span> <span class="n">voc</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> 
</pre></div>
</div>
</div>
</div>
<p>Finally, save the data frame as a CSV file using Panda’s <code class="docutils literal notranslate"><span class="pre">to_csv</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use Pandas&#39; built-in functionality</span>
<span class="n">voc</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;prices_of_coffee_over_time.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-11-4">
<h2>Exercise 11.4<a class="headerlink" href="#exercise-11-4" title="Permalink to this heading">#</a></h2>
<p>Download the CSV file ‘gutenberg_metadata.csv’ via the url <a class="reference external" href="https://edu.nl/xcm3q">https://edu.nl/xcm3q</a>.</p>
<p>Using this CSV file, create a dataframe which only contains the English texts written by Charles Dickens. In the data set, this name is given as ‘Dickens Charles’. Use the code ‘en’ for ‘English’.</p>
<p>Two different conditions can be combined using the amoersand (’&amp;’). The combined criteria must be given in brackets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://edu.nl/xcm3q&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="n">csv</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;gutenberg_metadata.csv&#39;</span> <span class="p">,</span> <span class="s1">&#39;w&#39;</span> <span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">csv</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;gutenberg_metadata.csv&#39;</span> <span class="p">)</span>
<span class="n">df_dickens</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Dickens Charles&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;language&#39;</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;en&#39;</span> <span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/Solutions"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="10%20Data_acquisition.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">10. Data acquisition</p>
      </div>
    </a>
    <a class="right-next"
       href="12%20Visualisation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">12. Visualisation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-1">Exercise 11.1.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-2">Exercise 11.2.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-3">Exercise 11.3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-11-4">Exercise 11.4</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peter Verhaar and Ben Companjen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>