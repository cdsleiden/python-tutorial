

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>10. Data acquisition &#8212; Python Tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/10 Data_acquisition';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Data analysis with pandas" href="11%20Pandas.html" />
    <link rel="prev" title="9. Regular Expressions" href="9%20Regular_expressions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../Welcome.html">
  
  
  
  
  
    <p class="title logo__title">Python Tutorial</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../Welcome.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1%20Variables_and_data_types.html">1. Statements, variables and data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="2%20Operators.html">2. Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="3%20Working_with_strings.html">3. Working with strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="4%20Flow_control.html">4. Flow control</a></li>

<li class="toctree-l1"><a class="reference internal" href="5%20Lists.html">5. Lists</a></li>

<li class="toctree-l1"><a class="reference internal" href="6%20Dictionaries.html">6. Dictionaries</a></li>

<li class="toctree-l1"><a class="reference internal" href="7%20Functions_modules_and_libraries.html">7. Functions, Modules and Libraries</a></li>

<li class="toctree-l1"><a class="reference internal" href="8%20Working_with_files_and_folders.html">8. Working with files and folders</a></li>

<li class="toctree-l1"><a class="reference internal" href="9%20Regular_expressions.html">9. Regular Expressions</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">10. Data acquisition</a></li>
<li class="toctree-l1"><a class="reference internal" href="11%20Pandas.html">11. Data analysis with pandas</a></li>

<li class="toctree-l1"><a class="reference internal" href="12%20Visualisation.html">12. Data Visualisation</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Practical information</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Jupyter_notebook_basics.html">Jupyter Notebook basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Other_resources.html">Other resources</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Solutions to the exercises</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Solutions/1%20Variables_and_data_types.html">1. Statements, variables and data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/2%20Operators.html">2. Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/3%20Working_with_strings.html">3. Working with strings</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/4%20Flow_control.html">4. Flow control</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/5%20Lists.html">5. Lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/6%20Dictionaries.html">6. Dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/7%20Functions_modules_and_libraries.html">7. Functions, Modules and Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/8%20Working_with_files_and_folders.html">8. Working with files and folders</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/9%20Regular_expressions.html">9. Regular expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/10%20Data_acquisition.html">10. Data acquisition</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/11%20Pandas.html">11. Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solutions/12%20Visualisation.html">12. Visualisation</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cdsleiden/python-tutorial/main?urlpath=tree/notebooks/10 Data_acquisition.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/10 Data_acquisition.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>10. Data acquisition</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-downloads">Direct downloads</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-1">Exercise 10.1.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acquiring-data-via-apis">Acquiring data via APIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-musicbrainz">Example: MusicBrainz</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-2">Exercise 10.2.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-3">Exercise 10.3.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-4">Exercise 10.4.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#webscraping">Webscraping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-scraping-scrapy">Advanced scraping: Scrapy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-5">Exercise 10.5.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-6">Exercise 10.6.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-7">Exercise 10.7.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-8">Exercise 10.8.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-9">Exercise 10.9.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-10">Exercise 10.10.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-11">Exercise 10.11.</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-acquisition">
<h1>10. Data acquisition<a class="headerlink" href="#data-acquisition" title="Permalink to this heading">#</a></h1>
<p>Data science projects typically start with the acquisition of data. Such data sets may consist of secondary data made available on the web by commercial or non-commercial organisations. This part of the tutorial explains how you can obtain such online data sets using code.</p>
<p>Many data sets can be downloaded manually through your browser, for example, from data portals or repositories. <a class="reference external" href="https://www.re3data.org/">Re3data</a> is a large overview of repositories for research data.</p>
<p>There can be good reasons for downloading data sets using a script. The manual acquisition of data may be tedious if the data collection consists of many files. In some cases, you may want to download files that are updated frequently.</p>
<p>In this tutorial, we distinguish three methods of data acquisition: downloading data files, accessing data through APIs and webscraping. You usually choose one of these methods to acquire your data, based on what the data provider offers.</p>
<section id="direct-downloads">
<h2>Direct downloads<a class="headerlink" href="#direct-downloads" title="Permalink to this heading">#</a></h2>
<p>If the resources that you are interested in are available directly via the web, you can download these files by making use of the <a class="reference external" href="https://requests.readthedocs.io/"><code class="docutils literal notranslate"><span class="pre">requests</span></code></a> library. As is the case for all libraries, the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library needs to be imported before you can use it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">requests</span></code> library can be used to make requests according to the <a class="reference external" href="https://en.wikipedia.org/wiki/HTTP">Hypertext Transfer Protocol (HTTP)</a>, which was developed to enable the exchange of information between computers. The computer that can provide information is typically referred to as a <em>server</em>, and the computer that requests information from this server is referred to as a <em>client</em>. In the HTTP protocol, the GET method is used to request data from a specified server.</p>
<p>In Python, such a GET request can be sent to a server using the <code class="docutils literal notranslate"><span class="pre">get()</span></code> method in <code class="docutils literal notranslate"><span class="pre">requests</span></code>, as demonstrated below. Evidently, it is important that you are online when you run this code.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="s1">&#39;https://www.universiteitleiden.nl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This method returns a so-called <code class="docutils literal notranslate"><span class="pre">Response</span></code> object. It is an object which represents information about the downloaded web resource. In the example above, the result of the method is assigned to a variable named <code class="docutils literal notranslate"><span class="pre">response</span></code>.</p>
<p>Once this <code class="docutils literal notranslate"><span class="pre">Response</span></code> object has been created successfully, you can use various pieces of information about the resource that was requested.
The property <code class="docutils literal notranslate"><span class="pre">status_code</span></code>, for instance, indicates the HTTP status code that was returned by the server.
The status code 200 indicates that the request was successful. The infamous status code 404 indicates that the file was not found.</p>
<p>If the status code is indeed 200, the contents of the resource is accessible in the response’s <code class="docutils literal notranslate"><span class="pre">content</span></code> property. This property holds the contents as bytes, however. When we downloaded a webpage, we typically want to work with the data as text. To obtain this text, we can work with the <code class="docutils literal notranslate"><span class="pre">text</span></code> property of the <code class="docutils literal notranslate"><span class="pre">Response</span></code> object. It contains the full contents of the downloaded resource as a string.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">requests</span></code> may not always understand a file’s <a class="reference external" href="https://www.w3.org/International/questions/qa-what-is-encoding">character encoding</a> automatically. You can set the correct character encoding explicitly using the <code class="docutils literal notranslate"><span class="pre">encoding</span></code> property.</p>
<p>When you run the code that is given below, the contents of the webpage that is specified in the <code class="docutils literal notranslate"><span class="pre">get()</span></code> method (or, more precisely, the HTML code that was created to build the webpage) becomes available as a string, assigned to the variable named <code class="docutils literal notranslate"><span class="pre">contents</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">contents</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;https://www.universiteitleiden.nl&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="p">)</span>

<span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
    <span class="n">response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
    <span class="n">contents</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">contents</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library, you can basically download any type of file from the web, as long as it is retrievable via HTTP(s). The code below, for instance, downloads a specific text file from the Project Gutenberg website.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.gutenberg.org/files/98/98-0.txt&quot;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="k">if</span> <span class="n">response</span><span class="p">:</span>
    <span class="n">response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span> 
    <span class="nb">print</span> <span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">if</span></code> keyword in the code above does not explicitly test whether the response code is 200. The Response object, which is created when you use the <code class="docutils literal notranslate"><span class="pre">get()</span></code> method from requests, automatically returns <code class="docutils literal notranslate"><span class="pre">True</span></code> when the status code is 200.</p>
<section id="exercise-10-1">
<h3>Exercise 10.1.<a class="headerlink" href="#exercise-10-1" title="Permalink to this heading">#</a></h3>
<p>The list below contains a number of URLs. They are the web addresses of texts created for the <a class="reference external" href="https://www.gutenberg.org">Project Gutenberg</a> website.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">urls</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;https://www.gutenberg.org/files/580/580-0.txt&#39;</span> <span class="p">,</span>
<span class="s1">&#39;https://www.gutenberg.org/files/1400/1400-0.txt&#39;</span> <span class="p">,</span>
<span class="s1">&#39;https://www.gutenberg.org/files/786/786-0.txt&#39;</span> <span class="p">,</span>
<span class="s1">&#39;https://www.gutenberg.org/files/766/766-0.txt&#39;</span> 
<span class="p">]</span>
</pre></div>
</div>
<p>Write a program in Python that can download all the files in this list and stores them in the current directory.</p>
<p>As filenames, use the same names that are used by Project Gutenberg (e.g. ‘580-0.txt’ or ‘1400-0.txt’).</p>
<p>The basename in a URL can be extracted using the <a class="reference external" href="https://docs.python.org/3/library/os.path.html#os.path.basename"><code class="docutils literal notranslate"><span class="pre">os.path.basename()</span></code></a> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="c1"># Recreate the given list using copy and paste</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">[</span>  
<span class="p">]</span>

<span class="c1"># We use a for-loop to take the same steps for each item in the list:</span>
<span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
    <span class="c1"># 1. Download the file contents</span>
    
    <span class="c1"># 1a. Force the textual contents to be interpreted as UTF-8 encoded, because the website does not send the text encoding</span>
    
    <span class="c1"># 2. Use basename() to get a suitable filename</span>
    
    <span class="c1"># 3. Open the file in write mode and write the downloaded file contents to the file</span>
    
    <span class="c1"># 4. Close the file</span>
    
    
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="acquiring-data-via-apis">
<h2>Acquiring data via APIs<a class="headerlink" href="#acquiring-data-via-apis" title="Permalink to this heading">#</a></h2>
<p>Organisations which aim to make their data available for reuse often do this through an <em>Application Programming Interface</em> (API). An API, simply put, is the interface through which (online) services and applications provide access to their information and functionalities.</p>
<p>It enables organisations to share some of the data that they have in a strucured format, so that other external parties can make use of these data in new applications.</p>
<p>The communication between the sender and the recipient of such requests needs to take place according to a specific protocol. The requests need to be formulated according to certain rules.</p>
<p>For many APIs, you need to create an access key (which may or may not require payment) before you can send requests. This is the case, for instance, for the Twitter/X API.</p>
<section id="example-musicbrainz">
<h3>Example: MusicBrainz<a class="headerlink" href="#example-musicbrainz" title="Permalink to this heading">#</a></h3>
<p>There are also many APIs that are open, in the sense that do not require registration. The <a class="reference external" href="https://musicbrainz.org/doc/MusicBrainz_API">MusicBrainz API</a>, for example, is free for non-commercial use. <em>MusicBrainz</em> is a large online encyclopedia containing information about musicians and their work. You can send requests to this API without having to provide an access key.</p>
<p>The root URL of this API is <a class="reference external" href="https://musicbrainz.org/ws/2/">https://musicbrainz.org/ws/2/</a></p>
<p>On MusicBrainz, you can request information about different entities, including artists, genres, instruments, labels and releases. The entity type you are interested in firstly needs to be appended to the root URL. If you want to search for information about an artist, for example, you need to work with the following URL structure: <code class="docutils literal notranslate"><span class="pre">https://musicbrainz.org/ws/2/artist[?parameters]</span></code></p>
<p>You can work with the following parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="p">[</span><span class="n">search</span> <span class="n">term</span><span class="p">]</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="p">[</span><span class="n">json</span> <span class="ow">or</span> <span class="n">xml</span><span class="p">]</span>
<span class="n">limit</span> <span class="o">=</span> <span class="p">[</span><span class="n">integer</span><span class="p">]</span>
</pre></div>
</div>
<p>Following the <code class="docutils literal notranslate"><span class="pre">query</span></code> parameter, you can supply the name of the artist you want to search for. Using the <code class="docutils literal notranslate"><span class="pre">fmt</span></code> parameter, you can specify whether you want to receive the result in <a class="reference external" href="https://www.w3.org/XML/">XML</a> or in <a class="reference external" href="https://www.json.org/">JSON</a> format. The API returns XML data by default. If the API returns many results, you can reduce the number of results by working with the <code class="docutils literal notranslate"><span class="pre">limit</span></code> parameter.</p>
<p>The following API call returns information about <em>The Beatles</em> in the JSON format.</p>
<p><a class="reference external" href="https://musicbrainz.org/ws/2/artist?query=The%20Beatles&amp;amp;fmt=json">https://musicbrainz.org/ws/2/artist?query=The Beatles&amp;fmt=json</a></p>
<p>Because this API is a Web API, you can send out such API calls using the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests.utils</span> <span class="kn">import</span> <span class="n">requote_uri</span>

<span class="n">root_url</span> <span class="o">=</span> <span class="s1">&#39;https://musicbrainz.org/ws/2/&#39;</span>

<span class="c1">## The parameters for the API call are defined as variables</span>
<span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;artist&#39;</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;David Bowie&#39;</span>
<span class="n">limit</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">requote_uri</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="n">api_call</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">root_url</span><span class="si">}{</span><span class="n">entity</span><span class="si">}</span><span class="s1">?query=</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&amp;fmt=</span><span class="si">{</span><span class="n">fmt</span><span class="si">}</span><span class="s1">&amp;limit=</span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">api_call</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">api_call</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the code above, the data that are returned by the <em>MusicBrainz</em> API are saved as an object named <code class="docutils literal notranslate"><span class="pre">response</span></code>. These data are structured according the format we specified, namely, JSON. To process these data, we can work with the <code class="docutils literal notranslate"><span class="pre">json()</span></code> method from the <code class="docutils literal notranslate"><span class="pre">request</span></code> library. This method parses the JSON data into regular Python data structures. JSON objects are converted into dictionaries, and JSON lists become regular Python lists.</p>
<p>The <em>MusicBrainz</em> API returns data which, at the first level, is structured as a JSON object. The <code class="docutils literal notranslate"><span class="pre">json()</span></code> method converts this JSON object into a dictionary. The result is assigned to an variable named <code class="docutils literal notranslate"><span class="pre">musicbrainz_results</span></code>. The keys of this dictionary are <code class="docutils literal notranslate"><span class="pre">created</span></code>, <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">offset</span></code> and <code class="docutils literal notranslate"><span class="pre">artists</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">musicbrainz_results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">musicbrainz_results</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As is the case for all dictionaries, you can use these keys to retrieve the values associated with these keys. When you use the key <code class="docutils literal notranslate"><span class="pre">artists</span></code>, you will notice that it is actually associated with actually a list. This list contains all the artists whose names or descriptions contains the search term you provided.</p>
<p>You can find information about these artists by iterating across the list in a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop. The data about each individual artist is structured, in turn, as a dictionary. For each individual artist, we can retrieve the name, using the <code class="docutils literal notranslate"><span class="pre">name</span></code> key, and the type, using the <code class="docutils literal notranslate"><span class="pre">type</span></code> key. The type attribute specifies whether we dealing with a person or with a group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">musicbrainz_results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="k">for</span> <span class="n">artist</span> <span class="ow">in</span> <span class="n">musicbrainz_results</span><span class="p">[</span><span class="s1">&#39;artists&#39;</span><span class="p">]:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">artist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;[unknown]&#39;</span><span class="p">)</span>
    <span class="n">artist_type</span> <span class="o">=</span> <span class="n">artist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;[unknown]&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">artist_type</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-10-2">
<h3>Exercise 10.2.<a class="headerlink" href="#exercise-10-2" title="Permalink to this heading">#</a></h3>
<p>As was discussed above, you can use the <em>MusicBrainz</em> API to request information about musicians. Via the code that is provided, you can request the names and the types of artists. This specific API can make much more information available, however. Try to add some code with can add the following data about each artist:</p>
<ul class="simple">
<li><p>The gender (in the case of a person)</p></li>
<li><p>The date of birth (in the case of a person) or formation (in the case of a group)</p></li>
<li><p>Aliases</p></li>
</ul>
<p>If you want to see the structure of the JSON data, you can ‘uncomment’ the print statement in the second cell to be able explore the structure of the JSON data.</p>
<p>The information about the date of birth or the date of formation is available via the key <code class="docutils literal notranslate"><span class="pre">life-span</span></code>. The value associated with this key is yet another dictionary. This second dictionary has the keys you need, namely <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">requests.utils</span> <span class="kn">import</span> <span class="n">requote_uri</span>


<span class="n">root_url</span> <span class="o">=</span> <span class="s1">&#39;https://musicbrainz.org/ws/2/&#39;</span>

<span class="c1">## The parameters for the API call are defined as variables</span>
<span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;artist&#39;</span>
<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;David Bowie&#39;</span>
<span class="n">limit</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;json&#39;</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">requote_uri</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="n">api_call</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">root_url</span><span class="si">}{</span><span class="n">entity</span><span class="si">}</span><span class="s1">?query=</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s1">&amp;fmt=</span><span class="si">{</span><span class="n">fmt</span><span class="si">}</span><span class="s1">&amp;limit=</span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">api_call</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="n">musicbrainz_results</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

<span class="k">for</span> <span class="n">artist</span> <span class="ow">in</span> <span class="n">musicbrainz_results</span><span class="p">[</span><span class="s1">&#39;artists&#39;</span><span class="p">]:</span>
    <span class="c1">#print(json.dumps(artist, indent=4))</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">artist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;[unknown]&#39;</span><span class="p">)</span>
    <span class="n">artist_type</span> <span class="o">=</span> <span class="n">artist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;[unknown]&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">artist_type</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    
    <span class="c1">## Add your code below</span>
    
    
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-10-3">
<h3>Exercise 10.3.<a class="headerlink" href="#exercise-10-3" title="Permalink to this heading">#</a></h3>
<p>Find the coordinates for each address in the given list using <a class="reference external" href="https://www.openstreetmap.org/">OpenStreetMap</a>’s Nominatim API.</p>
<p>The Nominatim API can be used, among other things, to find the precise geographic coordinates of a specific location. The base URL of this API is <a class="reference external" href="https://nominatim.openstreetmap.org/search">https://nominatim.openstreetmap.org/search</a>.</p>
<p>Following the <code class="docutils literal notranslate"><span class="pre">q</span></code> parameter, you need to supply a string describing the locations whose latitude and longitude you want to find. As values for the <code class="docutils literal notranslate"><span class="pre">format</span></code> parameter, you can use <code class="docutils literal notranslate"><span class="pre">xml</span></code> for XML-formatted data or <code class="docutils literal notranslate"><span class="pre">json</span></code> for JSON-formatted data.</p>
<p>Use this API to find the longitude and the latitude of the addresses in the following list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Grote Looiersstraat 17 Maastricht&#39;</span> <span class="p">,</span> <span class="s1">&#39;Witte Singel 27 Leiden&#39;</span> <span class="p">,</span>
<span class="s1">&#39;Singel 425 Amsterdam&#39;</span> <span class="p">,</span> <span class="s1">&#39;Drift 27 Utrecht&#39;</span> <span class="p">,</span> <span class="s1">&#39;Broerstraat 4 Groningen&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The JSON data received via the OpenStreetMap API can be converted to regular Python lists and dictionaries using the <code class="docutils literal notranslate"><span class="pre">json()</span></code> method:</p>
<p><code class="docutils literal notranslate"><span class="pre">json_data</span> <span class="pre">=</span> <span class="pre">response.json()</span></code></p>
<p>If the result is saved as variable named <code class="docutils literal notranslate"><span class="pre">json_data</span></code>, you should be able to access the latitude and the longitude as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">latitude</span> <span class="o">=</span> <span class="n">json_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span>
<span class="n">longitude</span> <span class="o">=</span> <span class="n">json_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">[0]</span></code> is used to get the results for the first result.</p>
<p>Print each address and its latitude and longitude coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">addresses</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Grote Looiersstraat 17 Maastricht&#39;</span> <span class="p">,</span> 
             <span class="s1">&#39;Witte Singel 27 Leiden&#39;</span><span class="p">,</span><span class="s1">&#39;Singel 425 Amsterdam&#39;</span> <span class="p">,</span> 
             <span class="s1">&#39;Drift 27 Utrecht&#39;</span> <span class="p">,</span> <span class="s1">&#39;Broerstraat 4 Groningen&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">addresses</span><span class="p">:</span>
    <span class="c1"># create the API call, with the address in the &#39;q&#39; parameter</span>
    
    <span class="c1"># Get the JSON data and process the data using json()</span>
    
    <span class="c1"># Find the latitude and the longitude of the first result</span>
    <span class="c1">#latitude = json_data[0][&#39;lat&#39;]</span>
    <span class="c1">#longitude = json_data[0][&#39;lon&#39;]</span>
    
    
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-10-4">
<h3>Exercise 10.4.<a class="headerlink" href="#exercise-10-4" title="Permalink to this heading">#</a></h3>
<p><em><a class="reference external" href="https://journals.plos.org/plosone/">PLOS One</a></em> is a peer reviewed open access journal. The <em>PLOS One</em> API can be used to request metadata about all the articles that have been published in the journal. In this API, you can refer to specific articles using their <a class="reference external" href="https://www.doi.org/">DOI</a>.</p>
<p>Such requests can be sent using API calls with the following structure:</p>
<p><a class="reference external" href="https://api.plos.org/search?q=id:%7Bdoi%7D">https://api.plos.org/search?q=id:{doi}</a></p>
<p>To acquire data about the article with DOI <a class="reference external" href="https://doi.org/10.1371/journal.pone.0270739">10.1371/journal.pone.0270739</a>, for example, you can use the following API call:</p>
<p><a class="reference external" href="https://api.plos.org/search?q=id:10.1371/journal.pone.0270739">https://api.plos.org/search?q=id:10.1371/journal.pone.0270739</a></p>
<p>Try to write code which can get hold of metadata about the articles with the following DOIs:</p>
<ul class="simple">
<li><p>10.1371/journal.pone.0169045</p></li>
<li><p>10.1371/journal.pone.0271074</p></li>
<li><p>10.1371/journal.pone.0268993</p></li>
</ul>
<p>For each article, print the title, the publication date, the article type, a list of all the authors and the abstract.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">dois</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;10.1371/journal.pone.0169045&#39;</span><span class="p">,</span>
        <span class="s1">&#39;10.1371/journal.pone.0268993&#39;</span><span class="p">,</span>
        <span class="s1">&#39;10.1371/journal.pone.0271074&#39;</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="webscraping">
<h2>Webscraping<a class="headerlink" href="#webscraping" title="Permalink to this heading">#</a></h2>
<p>When a website does not offer access to its structured data via a well-defined API, it may be an option to acquire the data that can be viewed on a site by making use of web scraping. It is a process in which a computer program tries to process the contents of given webpage, and to extract the data values that are needed. The aim of such an application is generally to copy information on a web page and to paste it into a local database.</p>
<p>To get the most out of webscraping, you need to have a basic understanding of HTML, the language that is use to make web pages. HTML, in short, encodes information in what are called elements or tags. The elements consist of a code surrounded by angular brackets, such as <code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;table&gt;</span></code>. Elements may also have attributes. in the HTML fragment <code class="docutils literal notranslate"><span class="pre">&lt;a</span> <span class="pre">href=&quot;https://example.com/&quot;&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">a</span></code> is the name of the element and <code class="docutils literal notranslate"><span class="pre">href</span></code> is the attribute. If you want to learn more about HTML, this <a class="reference external" href="https://bookandbyte.universiteitleiden.nl/DMT/HTML/HTML.pdf">basic introduction</a> may provide a start, but many other tutorials are available on the web.</p>
<p>Web scraping should be used with caution, because it may be not always be allowed to download large quantities of data from a specific website. In this tutorial, we will only discuss code that extracts information from single web pages.</p>
<p>To scrape web pages, you firstly need to download them. This can be done using the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library that was explained above.</p>
<p>The code below scrapes data from a website which was developed specifically for developers who want to practice their web scraping skills, <span class="xref myst">toscrape.com</span>. It is a safe web scraping sandbox. The web page <a class="reference external" href="http://books.toscrape.com/">http://books.toscrape.com/</a> displays a fictional bookstore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://books.toscrape.com/&#39;</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">url</span> <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>

<span class="k">if</span> <span class="n">response</span><span class="p">:</span>
    <span class="n">response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
    <span class="n">html_page</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span> 
    
</pre></div>
</div>
</div>
</div>
<p>Once you have downloaded the contents of a webpage, in the form of an HTML document, you can begin to extract the data values that you are interested in. This tutorial explains how you can extract the title of the price of each book listed on this web page.</p>
<p>One of the libraries that you can use in Python for scraping online resources is <a class="reference external" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/">Beautiful Soup</a>.</p>
<p>The code below firstly transforms the HTML code that was downloaded into a <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code> object. From the <code class="docutils literal notranslate"><span class="pre">bs4</span></code> library we import the <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code> class.</p>
<p>We then <em>construct</em> an object of this class, providing the full contents of an HTML document as a first parameter. As a second parameter, you need to provide the name one of the parsers that are available. Generally, a parser is an application which can process and analyse data. In this context, it refers to a program which can analyse the HTML file. One of the parsers that we can use is <code class="docutils literal notranslate"><span class="pre">lxml</span></code>. Using this parser, the <code class="docutils literal notranslate"><span class="pre">BeautifulSoup()</span></code> method converts the downloaded HTML page into a <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code> object.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">prettify()</span></code> method of this object creates a more readable version of the HTML file by adding indents and end of line characters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_page</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span> <span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">()</span> <span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<p>The output of the previous cell (i.e. the ‘prettified’ HTML code) can give you a sense of how the web page is structured. If you search for one of the titles (<em>Sapiens</em>, for example) using Control+F or Command+F, you can inspect the elements surrounding the book titles.</p>
<p>The books are all listed within an element named <code class="docutils literal notranslate"><span class="pre">&lt;ol&gt;</span></code>. This elements creates an ‘ordered list’. Inside the <code class="docutils literal notranslate"><span class="pre">&lt;ol&gt;</span></code>, there are separate <code class="docutils literal notranslate"><span class="pre">&lt;li&gt;</span></code> elements (‘list items’) for each book. Next, within each <code class="docutils literal notranslate"><span class="pre">&lt;li&gt;</span></code> element, we can find an element named <code class="docutils literal notranslate"><span class="pre">&lt;article&gt;</span></code>, with an attribute named <code class="docutils literal notranslate"><span class="pre">class</span></code>. The value of this attribute is <code class="docutils literal notranslate"><span class="pre">article_pod</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> &lt;article class=&quot;product_pod&quot;&gt;
 
           &lt;div class=&quot;image_container&quot;&gt;
            &lt;a href=&quot;catalogue/libertarianism-for-beginners_982/index.html&quot;&gt;
             &lt;img alt=&quot;Libertarianism for Beginners&quot; class=&quot;thumbnail&quot; src=&quot;media/cache/0b/bc/0bbcd0a6f4bcd81ccb1049a52736406e.jpg&quot;/&gt;
            &lt;/a&gt;
           &lt;/div&gt;

           &lt;h3&gt;
            &lt;a href=&quot;catalogue/libertarianism-for-beginners_982/index.html&quot; title=&quot;Libertarianism for Beginners&quot;&gt;
             Libertarianism for Beginners
            &lt;/a&gt;
           &lt;/h3&gt;
           &lt;div class=&quot;product_price&quot;&gt;
            &lt;p class=&quot;price_color&quot;&gt;
             £51.33
            &lt;/p&gt;
            
          &lt;/article&gt;
</pre></div>
</div>
<p>The title of the book can be found in an <code class="docutils literal notranslate"><span class="pre">h3</span></code> element. The price is given in a <code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code> element, with the class <code class="docutils literal notranslate"><span class="pre">price_color</span></code>. This <code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code> element is contained within a <code class="docutils literal notranslate"><span class="pre">&lt;div&gt;</span></code> with the class <code class="docutils literal notranslate"><span class="pre">product_price</span></code>. ‘Scraping’ the page really means that we need to extract the values we need from these HTML elements.</p>
<p>The BeautifulSoup object that was created above (and which was named <code class="docutils literal notranslate"><span class="pre">soup</span></code>) has a <code class="docutils literal notranslate"><span class="pre">find_all()</span></code> method, which you can use to find all occurrences of a specific HTML tag. The name of the tag (or element) needs to be mentioned as the first parameter.</p>
<p>As a second parameter, you can optionally specify whether you want to filter on the basis of specific attributes and attribute values. Such combinations of attributes and attribute values need to given in the form of a dictionary, with the name and the value of the attributes as a key and a value in the dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_books</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span> <span class="s1">&#39;article&#39;</span> <span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;product_pod&#39;</span><span class="p">}</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s2">&quot;The web page contains descriptions of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_books</span><span class="p">)</span><span class="si">}</span><span class="s2"> books&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As noted, the title of the book is can be found in an <code class="docutils literal notranslate"><span class="pre">&lt;h3&gt;</span></code> element underneath <code class="docutils literal notranslate"><span class="pre">&lt;article&gt;</span></code>. As there is only one <code class="docutils literal notranslate"><span class="pre">&lt;h3&gt;</span></code> element in this section of the web page, we can work with the <code class="docutils literal notranslate"><span class="pre">find()</span></code> method from <code class="docutils literal notranslate"><span class="pre">beautifulSoup</span></code>. This method only returns the first occurrece of the element that is mentioned as the first parameter.</p>
<p>The code below firstly iterates across all the books in the list(or, more precisely, the <code class="docutils literal notranslate"><span class="pre">&lt;article&gt;</span></code> elements offering information about the books), and extract the <code class="docutils literal notranslate"><span class="pre">&lt;h3&gt;</span></code> elements containing the title.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">find()</span></code> function returns the full element, including the tags in angual brackets. To retrieve only the text of a element (i.e. the text which is encoded using the tags), we can use the <code class="docutils literal notranslate"><span class="pre">text</span></code> property.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">all_books</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;h3&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">title</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can follow a similar approach to extract data about the prices, which can be found in a <code class="docutils literal notranslate"><span class="pre">&lt;p&gt;</span></code> element with the class <code class="docutils literal notranslate"><span class="pre">product_price</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">all_books</span><span class="p">:</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;h3&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">title</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    
    <span class="n">price</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;price_color&#39;</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">price</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The approach that was discussed seems to work, but there is still for improvement. The titles that are given in the <code class="docutils literal notranslate"><span class="pre">&lt;h3&gt;</span></code> headings are sometimes shortened, because there is not always enough space on the web page to display the full titles.</p>
<p>To solve this issue, we can also extract the titles from the <code class="docutils literal notranslate"><span class="pre">title</span></code> attribute in the <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> element underneath the <code class="docutils literal notranslate"><span class="pre">&lt;h3&gt;</span></code> element. In the HTML standard, the <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> element is used to create hyperlinks. The <code class="docutils literal notranslate"><span class="pre">href</span></code> attribute in <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> specifies the target of the hyperlink. The <code class="docutils literal notranslate"><span class="pre">title</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> can give information about this target.</p>
<p>To retrieve the value of an attribute, we can use the <code class="docutils literal notranslate"><span class="pre">get()</span></code> method. As an argument, this method demands the name of the attibute we are interested in. To retrieve the title, we should specify that we are interested in the value of the <code class="docutils literal notranslate"><span class="pre">title</span></code> attribute.</p>
<p>The code below retrieves these titles in two stages. As first step, we retrieve the <code class="docutils literal notranslate"><span class="pre">&lt;h3&gt;</span></code> element. Secondly, we retrieve the <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> element underneath this <code class="docutils literal notranslate"><span class="pre">&lt;h3&gt;</span></code>. This additonal step is added because there are actually different <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> elements within the <code class="docutils literal notranslate"><span class="pre">&lt;article&gt;</span></code>. The appoach implemeted in the cell below ensures that we only retrieve the hyperlink (i.e. the <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> element) in <code class="docutils literal notranslate"><span class="pre">&lt;h3&gt;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">all_books</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;h3&#39;</span><span class="p">)</span>
    <span class="n">hyperlink</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">hyperlink</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="advanced-scraping-scrapy">
<h2>Advanced scraping: Scrapy<a class="headerlink" href="#advanced-scraping-scrapy" title="Permalink to this heading">#</a></h2>
<p>As you can see, web scraping can easily become rather difficult. You need to inspect the structure of the HTML source quite carefully, and you often need to work with fairly complicated code to extract only the values that you need. This tutorial has only touched the surface of web scraping. To get specific data from webpages or APIs, you will often need to dig deeply into the data that you get.</p>
<p>A more advanced framework (or toolkit) for webscraping with Python is <a class="reference external" href="https://scrapy.org">Scrapy</a>. This framework can simplify the process of building a scraper/crawler considerably. Scrapy helps you to ensure that you don’t send too many requests at the same time, for example. The <a class="reference external" href="https://docs.scrapy.org/en/latest/intro/tutorial.html">Scrapy tutorial</a> offers more information on this library.</p>
<section id="exercise-10-5">
<h3>Exercise 10.5.<a class="headerlink" href="#exercise-10-5" title="Permalink to this heading">#</a></h3>
<p>This tutorial has explained how you can extract data about the titles and the prices of all the books that are shown on the web page <a class="reference external" href="http://books.toscrape.com/">http://books.toscrape.com/</a>.</p>
<p>Can you write code to extract the URLs of all the book covers on this page? These URLs can be found in the <code class="docutils literal notranslate"><span class="pre">src</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> elements within the <code class="docutils literal notranslate"><span class="pre">&lt;article&gt;</span></code> about each book. Note that the <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> element specifies a relative path. To change the relative path into an absolute path, you need to concatenate the base url (<a class="reference external" href="http://books.toscrape.com/">http://books.toscrape.com/</a> and the relative path to the image.</p>
</section>
<section id="exercise-10-6">
<h3>Exercise 10.6.<a class="headerlink" href="#exercise-10-6" title="Permalink to this heading">#</a></h3>
<p>On the web page <a class="reference external" href="http://books.toscrape.com/">http://books.toscrape.com/</a>, the menu on the lefthand side contains a list of all the subject categories of the books.</p>
<p>Try to write some code which can extract all the terms in this list. This list is in an element named <code class="docutils literal notranslate"><span class="pre">div</span></code>, and this <code class="docutils literal notranslate"><span class="pre">&lt;div&gt;</span></code> has a <code class="docutils literal notranslate"><span class="pre">class</span></code> attribute with the value <code class="docutils literal notranslate"><span class="pre">side_categories</span></code>. The categories themselves are all encoded within an <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code> element.</p>
</section>
<section id="exercise-10-7">
<h3>Exercise 10.7.<a class="headerlink" href="#exercise-10-7" title="Permalink to this heading">#</a></h3>
<p>Write a program in Python which can extract data from the following web page:</p>
<p><a class="reference external" href="https://www.imdb.com/chart/top/">https://www.imdb.com/chart/top/</a></p>
<p>This is a page on the <a class="reference external" href="https://www.imdb.com">Internet Movie Database website</a>. It lists the 25 most highly rated movies.</p>
<p>More specifically, try to extract the titles of these movies and the URLs of the pages on IMDB.</p>
<p>If you inspect the source code of this web page, you can see that the information about the movies is encoded as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">td</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;titleColumn&quot;</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;/title/tt0068646/&quot;</span><span class="o">&gt;</span>
<span class="n">The</span> <span class="n">Godfather</span>
<span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>

<span class="o">&lt;/</span><span class="n">td</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The data can found in a <code class="docutils literal notranslate"><span class="pre">&lt;td&gt;</span></code> element whose <code class="docutils literal notranslate"><span class="pre">class</span></code> attribute has value <code class="docutils literal notranslate"><span class="pre">titleColumn</span></code>. <code class="docutils literal notranslate"><span class="pre">td</span></code> stands for ‘table data’. This HTML element is used to create a cell in a table. The actual title in given in a hyperlink, encoded using <code class="docutils literal notranslate"><span class="pre">&lt;a&gt;</span></code>. The URL to the page for the movie is given in an ‘href’ attribute.</p>
<p>There is one additional challenge that you need to be aware of. The IMDB website only responds to requests received from web scraping scripts if these requests also specify a ‘User-Agent’ in the a header. Each HTTP request contains a header, which provides important metadata about the request. The ‘User-Agent’ in this header typically gives imformation about the Computer and the browser from which the request was sent.</p>
<p>The easiest way to find an approproate value for a ‘User-Agent’ is to go to <a class="reference external" href="https://scrapfly.io/blog/how-to-avoid-web-scraping-blocking-headers/">a website listing some common options</a>, and to select the case that applies.</p>
<p>The information about the ‘User-Agent’ in the header must be provided in the <code class="docutils literal notranslate"><span class="pre">header</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">get()</span></code> method of <code class="docutils literal notranslate"><span class="pre">requests</span></code>, in the form of a dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.imdb.com/chart/top/&#39;</span>

<span class="c1">## You can use the value below if you use Firefox on a Mac</span>
<span class="c1">## Adjust the value of user_agent if that is not the case.</span>
<span class="n">user_agent</span> <span class="o">=</span> <span class="s1">&#39;&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:98.0) Gecko/20100101 Firefox/98.0&quot;&#39;</span>
<span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="n">user_agent</span><span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span> <span class="n">url</span> <span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>

<span class="k">if</span> <span class="n">response</span><span class="p">:</span>
    <span class="n">response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
    <span class="n">html_page</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Add your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-10-8">
<h3>Exercise 10.8.<a class="headerlink" href="#exercise-10-8" title="Permalink to this heading">#</a></h3>
<p>The webpage below offers access to the complete work of the author H.P. Lovecraft.</p>
<p><a class="reference external" href="https://www.hplovecraft.com/writings/texts/">https://www.hplovecraft.com/writings/texts/</a></p>
<p>Write code in Python to find and print the URLs of all the texts that are listed. The links are all encoded in an element named &lt;a&gt;. The attribute <code class="docutils literal notranslate"><span class="pre">href</span></code> mentions the links, and the body of the &lt;a&gt; element mentions the title. List only the web pages that end in ‘.aspx’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.hplovecraft.com/writings/texts/&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-10-9">
<h3>Exercise 10.9.<a class="headerlink" href="#exercise-10-9" title="Permalink to this heading">#</a></h3>
<p>Using <code class="docutils literal notranslate"><span class="pre">requests</span></code> and <code class="docutils literal notranslate"><span class="pre">BeautifulSoup</span></code>, create a list of all the countries mentioned on <a class="reference external" href="https://www.scrapethissite.com/pages/simple/">https://www.scrapethissite.com/pages/simple/</a>.</p>
<p>Also collect and print data about the capital, the population and the area of all of these countries.</p>
<p>How you print or present the information is not too important here; the challenge in this exercise is to extract the data from the webpage.</p>
</section>
<section id="exercise-10-10">
<h3>Exercise 10.10.<a class="headerlink" href="#exercise-10-10" title="Permalink to this heading">#</a></h3>
<p>Download all the images shown on the following page: <a class="reference external" href="https://www.bbc.com/news/in-pictures-61014501">https://www.bbc.com/news/in-pictures-61014501</a></p>
<p>You can follow these steps:</p>
<ol class="arabic simple">
<li><p>Download the HTML file</p></li>
<li><p>‘Scrape’ the HTML file you downloaded. As images in HTML are encoded using the <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> element, try to create a list containing all occurrences of this element.</p></li>
<li><p>Find the URLS of all the images. Within these <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> element, there should be a <code class="docutils literal notranslate"><span class="pre">src</span></code> attribute containing the URL of the image.</p></li>
<li><p>The <a class="reference external" href="http://bbc.com">bbc.com</a> website uses images as part of the user interface. These images all have the word ‘line’ in their filenames. Try to exclude these images whose file names contain the word ‘line’.</p></li>
<li><p>Download all the images that you found in this way, using the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library. In the <code class="docutils literal notranslate"><span class="pre">Response</span></code> object that is created following a succesful download, you need to work with the <code class="docutils literal notranslate"><span class="pre">content</span></code> property to obtain the actual file.  Save all these images on your computer, using <code class="docutils literal notranslate"><span class="pre">open()</span></code> and <code class="docutils literal notranslate"><span class="pre">write()</span></code>. In the <code class="docutils literal notranslate"><span class="pre">open()</span></code> function, use the string <code class="docutils literal notranslate"><span class="pre">&quot;wb&quot;</span></code> (write binary) as a second parameter (instead of only <code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code>) to make sure that the contents are saved as bytes.</p></li>
</ol>
</section>
<section id="exercise-10-11">
<h3>Exercise 10.11.<a class="headerlink" href="#exercise-10-11" title="Permalink to this heading">#</a></h3>
<p>Write Python code which can download the titles and the URLs of Wikipedia articles whose titles contain the word ‘Dutch’. Your code needs to display the first 30 results only.</p>
<p>You can search for Wikipedia pages containing a certain term using the following base URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://en.wikipedia.org/w/api.php?action=opensearch&#39;</span>
</pre></div>
</div>
<p>As you can read in the <a class="reference external" href="https://www.mediawiki.org/w/api.php?action=help&amp;modules=opensearch">documentation of this API</a>, the <code class="docutils literal notranslate"><span class="pre">opensearch</span></code> function accepts the following parameters:</p>
<ul class="simple">
<li><p><em>query</em> speficies the search term.</p></li>
<li><p><em>limit</em> sets a limit to the number of items to return</p></li>
<li><p>For the <em>format</em>, you can choose either ‘xml’ or ‘json’.</p></li>
</ul>
<p>If you request data in the JSON format, and convert the data using the <code class="docutils literal notranslate"><span class="pre">json()</span></code> method of <code class="docutils literal notranslate"><span class="pre">requests</span></code>, these data will be structured in quite a particular way. At the first level, the object is list containing four items. The second item is another list, containing the titles of the articles. The fourth item is yet another list, containing the URLs of all of these articles.</p>
<p>Note that this can be a challenging exercise!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Let&#39;s construct the full API call (which is a URL) piece by piece</span>
<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://en.wikipedia.org/w/api.php?action=opensearch&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="9%20Regular_expressions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">9. Regular Expressions</p>
      </div>
    </a>
    <a class="right-next"
       href="11%20Pandas.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">11. Data analysis with pandas</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-downloads">Direct downloads</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-1">Exercise 10.1.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#acquiring-data-via-apis">Acquiring data via APIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-musicbrainz">Example: MusicBrainz</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-2">Exercise 10.2.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-3">Exercise 10.3.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-4">Exercise 10.4.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#webscraping">Webscraping</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-scraping-scrapy">Advanced scraping: Scrapy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-5">Exercise 10.5.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-6">Exercise 10.6.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-7">Exercise 10.7.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-8">Exercise 10.8.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-9">Exercise 10.9.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-10">Exercise 10.10.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-10-11">Exercise 10.11.</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Peter Verhaar and Ben Companjen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>